---
title: "RNN"
output: html_document
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Rede Neuronales Recurrentes para Series de Tiempo

Utilizaremos series de tiempo financieras para ilustrar el uso de las RNN. Son datos diarios de la bolsa de Nueva York del 2 de diciembre de 1962 al 31 de diciembre de 198:

* Volumen de operaciones en escala logarítmica. Es la fracción de todas operaciones en circulación que se negocian un día $t$, en relación con un promedio móvil del 100 días de facturación pasada en escala logarítmica.
* Retorno del índice Dow Jones. Es la diferencia entre el logarítmo de índice industrial Dow Jones en días consecutivos.
* Logarítmo de la volatilidad. Es basado en los valores absolutos de los moviminetos del precio diario


```{r Datos y grafica}
library (ISLR2)
library(zoo)
library(xts)
data(NYSE)
xdata <- data.matrix (NYSE[, c("DJ_return", "log_volume","log_volatility")])
ts_data=timeSeries(NYSE[,c("DJ_return","log_volume","log_volatility")],NYSE$date)
par(mfrow=c(1, 1))
plot(ts_data, plot.type="m")
str(ts_data)
```
Tomamos muestra de entrenamineto
```{r tomar entrenamineto}
istrain <- NYSE[, "train"]
xdata <- scale(xdata)
```





## Creación de variables rezagadas o retardadas

Crearemos una función para generar las variables rezagadas
```{r rezagadas}
lagm <- function (x, k = 1) {
 n <- nrow (x)
 pad <- matrix (NA , k, ncol (x))
 rbind (pad , x[1:(n - k), ])
}


```

# Data Frame de retardos
```{r dataframe lags }
arframe <- data.frame (log_volume = xdata[, "log_volume"],
L1 = lagm (xdata , 1), L2 = lagm (xdata , 2),
L3 = lagm (xdata , 3), L4 = lagm (xdata , 4),
L5 = lagm (xdata , 5)
)
```




